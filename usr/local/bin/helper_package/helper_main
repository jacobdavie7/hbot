#!/bin/bash

MAIN_DIR=/usr/local/bin/helper_package/helperModules
#MAIN_DIR=/srv/git/helper/usr/local/bin/helper_package/helperModules

# general
    source $MAIN_DIR/general/updater.sh
    source $MAIN_DIR/general/xfceFix.sh
    source $MAIN_DIR/general/clean.sh

# config
    source $MAIN_DIR/config/drawing.sh
    source $MAIN_DIR/config/monitors.sh

    source $MAIN_DIR/config/timezone.sh

        # vpn
            source $MAIN_DIR/config/vpn/vpnHome.sh
            source $MAIN_DIR/config/vpn/vpnMobile.sh
            source $MAIN_DIR/config/vpn/vpnHighRisk.sh

# firewalls
    source $MAIN_DIR/firewalls/firewallWatcher.sh
    source $MAIN_DIR/firewalls/firewallPersistentSave.sh
    
    # rulesets
        source $MAIN_DIR/firewalls/rulesets/firewallHome.sh
        source $MAIN_DIR/firewalls/rulesets/firewallWeb.sh
        source $MAIN_DIR/firewalls/rulesets/firewallBackup.sh
        source $MAIN_DIR/firewalls/rulesets/firewallReset.sh
        source $MAIN_DIR/firewalls/rulesets/firewallHomeLimited.sh
        source $MAIN_DIR/firewalls/rulesets/firewallHomeLimitedVPN.sh
        source $MAIN_DIR/firewalls/rulesets/firewallHomeLax.sh
        source $MAIN_DIR/firewalls/rulesets/firewallClass.sh
        source $MAIN_DIR/firewalls/rulesets/firewallLocal.sh
        source $MAIN_DIR/firewalls/rulesets/firewallSecure.sh
        source $MAIN_DIR/firewalls/rulesets/firewallv6Basic.sh
        source $MAIN_DIR/firewalls/rulesets/firewallWebWoL.sh

# special
    source $MAIN_DIR/special/install.sh
    source $MAIN_DIR/special/startup.sh

# support
    source $MAIN_DIR/support/usage.sh
    source $MAIN_DIR/support/runSudo.sh
    source $MAIN_DIR/support/elevateCheck.sh
    source $MAIN_DIR/support/userAccount.sh
    
while getopts "umdsf:iwav:xct:" FLAG; do
    case "$FLAG" in
        u)
            elevateCheck
            updater
            exit
            ;;

        m)
            monitors
            exit
            ;;

        d)
            drawing
            exit
            ;;

        s)
            elevateCheck
            startup
            exit
            ;;

        f)
            elevateCheck
            userAccount
            if [ "$OPTARG" == "home" ]; then
                firewallHome
            elif [ "$OPTARG" == "web" ]; then
                firewallWebServer
            elif [ "$OPTARG" == "backup" ]; then
                firewallBackupServer
            elif [ "$OPTARG" == "limited" ]; then
                firewallHomeLimited
            elif [ "$OPTARG" == "reset" ]; then
                firewallReset
            elif [ "$OPTARG" == "lax" ]; then
                firewallHomeLax
            elif [ "$OPTARG" == "local" ]; then
                firewallLocal
            elif [ "$OPTARG" == "secure" ]; then
                firewallHomeSecure
            elif [ "$OPTARG" == "class" ]; then
                firewallClass
            elif [ "$OPTARG" == "wol" ]; then
                firewallWoL
            else
                echo -e "\n\e[31mSorry, but '$OPTARG' is not a valid argument. See valid Arugments for option 'firewall' below\e[39m"
                usage
            fi
            exit
            ;;

        i)
            elevateCheck
            install
            exit
            ;;

        w)
            elevateCheck
            firewallWatcher
            exit
            ;;

        x)
            userAccount
            xfceFix
            exit
            ;;

        v)
            elevateCheck    #needed for firewall
            if [ "$OPTARG" == "home" ]; then
                vpnHome
            elif [ "$OPTARG" == "mobile" ]; then
                vpnMobile
            elif [ "$OPTARG" == "high" ]; then
                vpnHighRisk
            else
                echo -e "\n\e[31mSorry, but '$OPTARG' is not a valid argument. See valid Arugments for option 'vpn' below\e[39m"
                usage
            fi
            exit
            ;;

        c)
            elevateCheck
            userAccount
            clean
            exit
            ;;

        t)
            elevateCheck
            if [ "$OPTARG" == "pacific" ]; then
                timezonePacific
            exit
            elif [ "$OPTARG" == "mountain" ]; then
                timezoneMountain
            exit
            elif [ "$OPTARG" == "central" ]; then
                timezoneCentral
            exit
            elif [ "$OPTARG" == "eastern" ]; then
                timezoneEastern
            exit
            elif [ "$OPTARG" == "arizona" ]; then
                timezoneArizona
            exit
            elif [ "$OPTARG" == "korea" ]; then
                timezoneKorea
            exit
            elif [ "$OPTARG" == "auto" ]; then
                timezoneAuto
            exit
            else
                echo -e "\n\e[31mSorry, but '$OPTARG' is not a valid argument. See valid Arugments for option 'timezone' below\e[39m"
                usage
            fi
            exit
            ;;

    esac
done

usage #calls help function in help.sh file